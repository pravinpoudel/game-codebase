{"version":3,"sources":["game-play.js"],"names":["GamePlay","manager","input","myKeyboard","myMouse","lastTimeStamp","model","initialize","bind","run","playerModel","self","wallModel","renderCircle","sound","particlesSmoke","creeps","makeCreateCreep1","makeCreateCreep2","makeCreateCreep3","towers","registerKey","flyingScores","tower1","Image","src","render","firstTime","downHandler","myTower","getAttribute","selectedTower","console","log","mouse","isActive","e","elapsedTime","push","createTower","x","y","length","canvasPosition","canvas","getBoundingClientRect","towerElements","document","getElementsByClassName","i","style","display","myId","getElementById","Mouse","register","GameState","cancelNextRequest","showScreen","addEventListener","createElement","towerElements2","muteVolume","bulletController","BulletController","clientX","left","clientY","top","update","upgrade","localStorage","sell","start","cleanAll","life","creepsLength","creep","reachRight","splice","health","player","specs","center","score","maxHealth","textEvent","MovingEvents","size","rotation","moveRate","rotateRate","Math","PI","continousSpeed","yDirection","xDirection","FlyingScore","towersLength","tower","isColliding","setTarget","canShoot","direction","target","normalize","bulletStartX","bulletStartY","addBullet","power","scorelength","isVisible","innerHTML","money","wave","wavesDeno","wavesNeno","context","clearRect","width","height","beginPath","moveTo","lineTo","stroke","drawTower","renderScore","forEach","Sound","loadAudio","performance","now","gameLoop","time","processInput","requestAnimationFrame"],"mappings":"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","sourcesContent":["class GamePlay {\r\n  constructor(manager, input) {\r\n    this.myKeyboard = input;\r\n    this.myMouse = null;\r\n    this.lastTimeStamp;\r\n    this.manager = manager;\r\n    this.model = null;\r\n    this.initialize = this.initialize.bind(this);\r\n    this.run = this.run.bind(this);\r\n    this.playerModel = null;\r\n    self.wallModel = null;\r\n    this.renderCircle = false;\r\n    this.sound = null;\r\n    this.particlesSmoke = null;\r\n    this.creeps = [\r\n      makeCreateCreep1(520, 300),\r\n      makeCreateCreep2(700, 300),\r\n      makeCreateCreep3(800, 300),\r\n    ];\r\n    this.towers = [];\r\n    this.registerKey = this.registerKey.bind(this);\r\n    this.flyingScores = [];\r\n    this.tower1 = new Image();\r\n    this.tower1.src = \"assets/turret/turret-5-3.png\";\r\n    this.render = this.render.bind(this);\r\n    this.firstTime = true;\r\n    this.downHandler = this.downHandler.bind(this);\r\n  }\r\n\r\n  createElement() {\r\n    let myTower = this.getAttribute(\"data-myName\");\r\n    selectedTower = \"assets/turret/\" + myTower;\r\n    console.log(selectedTower);\r\n    renderCircle = true;\r\n    mouse.isActive = true;\r\n  }\r\n\r\n  downHandler(e, elapsedTime) {\r\n    if (mouse.isActive) {\r\n      firstTime = true;\r\n      mouse.isActive = false;\r\n      renderCircle = false;\r\n      console.log(selectedTower);\r\n      this.towers.push(createTower(selectedTower, mouse.x, mouse.y, 1000, 1));\r\n      console.log(this.towers.length);\r\n      const canvasPosition = canvas.getBoundingClientRect();\r\n      mouse.x = e.x;\r\n      mouse.y = e.y;\r\n    }\r\n  }\r\n\r\n  muteVolume(e) {\r\n    var towerElements = document.getElementsByClassName(\"volumeButton\");\r\n    for (var i = 0; i < towerElements.length; i++) {\r\n      towerElements[i].style.display = \"block\";\r\n    }\r\n    let myId = this.getAttribute(\"data-myId\");\r\n    document.getElementById(myId).style.display = \"none\";\r\n  }\r\n\r\n  initialize() {\r\n    let self = this;\r\n    this.myMouse = new Mouse();\r\n    self.myKeyboard.register(\"Escape\", function () {\r\n      GameState.cancelNextRequest = true;\r\n      self.manager.showScreen(\"mainmenu\");\r\n    });\r\n\r\n    var towerElements = document.getElementsByClassName(\"tower\");\r\n    for (var i = 0; i < towerElements.length; i++) {\r\n      towerElements[i].addEventListener(\"click\", this.createElement, false);\r\n    }\r\n\r\n    var towerElements2 = document.getElementsByClassName(\"volumeButton\");\r\n    for (var i = 0; i < towerElements2.length; i++) {\r\n      towerElements2[i].addEventListener(\"click\", this.muteVolume, false);\r\n    }\r\n\r\n    this.bulletController = new BulletController();\r\n\r\n    this.towers.push(\r\n      createTower(\"assets/turret/turret-5-3.png\", 300, 500, 1000, 1)\r\n    );\r\n    this.towers.push(\r\n      createTower(\"assets/turret/turret-3-3.png\", 600, 500, 2000, 2)\r\n    );\r\n\r\n    this.myMouse.register(\"mousedown\", this.downHandler);\r\n\r\n    // this.myMouse.register('mouseup', function(e, elapsedTime) {\r\n    //   mouse.isActive = false;\r\n    // });\r\n\r\n    this.myMouse.register(\"mousemove\", function (e, elapsedTime) {\r\n      if (mouse.isActive) {\r\n        const canvasPosition = canvas.getBoundingClientRect();\r\n        mouse.x = e.clientX - canvasPosition.left;\r\n        mouse.y = e.clientY - canvasPosition.top;\r\n        if (mouse.y < 200) {\r\n          mouse.y = 200;\r\n        }\r\n        this.renderCircle = true;\r\n      }\r\n    });\r\n  }\r\n\r\n  processInput(elapsedTime) {\r\n    this.myKeyboard.update(elapsedTime);\r\n    this.myMouse.update(elapsedTime);\r\n  }\r\n\r\n  registerKey() {\r\n    let self = this;\r\n    let upgrade = localStorage[\"upgrade\"];\r\n    let sell = localStorage[\"sell\"];\r\n    let start = localStorage[\"start\"];\r\n    self.myKeyboard.cleanAll();\r\n  }\r\n\r\n  update(elapsedTime) {\r\n    if (GameState.life <= 0) {\r\n      GameState.cancelNextRequest = true;\r\n      this.particlesSmoke.update(elapsedTime);\r\n      return;\r\n    }\r\n    let creepsLength = this.creeps.length;\r\n    for (let i = 0; i < creepsLength; i++) {\r\n      let creep = this.creeps[i];\r\n      if (creep) {\r\n        if (creep.reachRight()) {\r\n          this.creeps.splice(i, 1);\r\n          GameState.life--;\r\n          console.log(GameState.life);\r\n          continue;\r\n        }\r\n        if (creep.health == 0) {\r\n          let x = creep.player.specs.center.x;\r\n          let y = creep.player.specs.center.y;\r\n          score += creep.maxHealth;\r\n          this.creeps.splice(i, 1);\r\n          let textEvent = new MovingEvents({\r\n            size: { x: 50, y: 50 }, // Size in pixels\r\n            center: { x: x, y: y },\r\n            rotation: 0,\r\n            moveRate: 125 / 1000, // Pixels per second\r\n            rotateRate: Math.PI / 1000, // Radians per second\r\n            continousSpeed: 50,\r\n            yDirection: -1,\r\n            xDirection: 0,\r\n          });\r\n          this.flyingScores.push(\r\n            new FlyingScore(creep.maxHealth, textEvent, true)\r\n          );\r\n          continue;\r\n        }\r\n        creep.update(elapsedTime);\r\n        let towersLength = this.towers.length;\r\n        for (let i = 0; i < towersLength; i++) {\r\n          let tower = this.towers[i];\r\n          if (isColliding(creep, tower, 200)) {\r\n            tower.setTarget(\r\n              creep.player.specs.center.x,\r\n              creep.player.specs.center.y\r\n            );\r\n            if (tower.canShoot) {\r\n              let direction = {\r\n                x: tower.specs.target.x - tower.specs.center.x,\r\n                y: tower.specs.target.y - tower.specs.center.y,\r\n              };\r\n              direction = normalize(direction);\r\n              let bulletStartX = tower.specs.center.x;\r\n              let bulletStartY = tower.specs.center.y;\r\n\r\n              this.bulletController.addBullet(\r\n                bulletStartX,\r\n                bulletStartY,\r\n                creep,\r\n                tower.specs.power\r\n              );\r\n            }\r\n          }\r\n          tower.update(elapsedTime);\r\n        }\r\n      }\r\n    }\r\n\r\n    this.bulletController.update(elapsedTime);\r\n    let scorelength = this.flyingScores.length;\r\n    for (let i = 0; i < scorelength; i++) {\r\n      this.flyingScores[i].update(elapsedTime);\r\n      if (!this.flyingScores[i].isVisible) {\r\n        this.flyingScores.splice(i, 1);\r\n        i--;\r\n        scorelength--;\r\n      }\r\n    }\r\n  }\r\n\r\n  renderScore() {\r\n    document.getElementById(\"currentScore\").innerHTML = score;\r\n    document.getElementById(\"lives\").innerHTML = GameState.life;\r\n    document.getElementById(\"money\").innerHTML = money;\r\n    let wave = wavesDeno + \"/\" + wavesNeno;\r\n    document.getElementById(\"wave\").innerHTML = wave;\r\n  }\r\n\r\n  render() {\r\n    context.clearRect(0, 0, canvas.width, canvas.height);\r\n    context.beginPath();\r\n    context.moveTo(0, 200);\r\n    context.lineTo(canvas.width, 200);\r\n    context.stroke();\r\n    if (renderCircle) {\r\n      drawTower(50);\r\n    }\r\n    this.renderScore();\r\n    this.creeps.forEach((creep) => {\r\n      creep.render();\r\n    });\r\n    let towersLength = this.towers.length;\r\n    for (let i = 0; i < towersLength; i++) {\r\n      let tower = this.towers[i];\r\n      tower.render();\r\n    }\r\n    this.bulletController.render();\r\n    let scorelength = this.flyingScores.length;\r\n    for (let i = 0; i < scorelength; i++) {\r\n      this.flyingScores[i].render();\r\n    }\r\n  }\r\n\r\n  run() {\r\n    let self = this;\r\n    this.sound = new Sound();\r\n    this.sound.loadAudio();\r\n    // this.sound.playSound(\"end\");\r\n    this.registerKey();\r\n\r\n    let lastTimeStamp = performance.now();\r\n    GameState.cancelNextRequest = false;\r\n\r\n    function gameLoop(time) {\r\n      self.processInput(time - lastTimeStamp);\r\n      self.update(time - lastTimeStamp);\r\n      lastTimeStamp = time;\r\n      self.render();\r\n      if (!GameState.cancelNextRequest) {\r\n        requestAnimationFrame(gameLoop);\r\n      }\r\n    }\r\n    requestAnimationFrame(gameLoop);\r\n  }\r\n}\r\n"],"file":"game-play.dev.js"}
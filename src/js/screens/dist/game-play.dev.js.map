{"version":3,"sources":["game-play.js"],"names":["GamePlay","manager","input","myKeyboard","myMouse","lastTimeStamp","model","initialize","bind","run","playerModel","self","wallModel","renderCircle","sound","particlesSmoke","creeps","towers","registerKey","flyingScores","tower1","Image","src","render","firstTime","downHandler","enemyCreator","canPlace","upgrade","sell","renderScore","startNewWave","level","towerType","gameOverText","alreadyUpgraded","alreadyStarted","elapsedTime","moneyRequired","Math","floor","towerClicked","specs","cost","money","upgradeCount","delay","power","gameSound","playSound","towerLength","length","i","isColliding2","center","x","cellWidth","y","towerSold","splice","selectedTower","getAttribute","towerRadius","parseInt","towerTypeSelected","mouse","isActive","e","decision","canCreated","push","createTower","GameState","assets","canvasPosition","canvas","getBoundingClientRect","clientX","left","clientY","top","findSelectedTower","preventDefault","towerElements","document","getElementsByClassName","style","display","myId","getElementById","stopAllSound","unMuteSound","console","log","levels","sendNextWave","startButton","nextWave","cancelNextRequest","add","score","life","createLevels","makeParticle2","Mouse","register","showScreen","rows","row","j","cols","cellSet","addEventListener","createElement","towerElements2","muteVolume","bulletController","BulletController","update","localStorage","start","particleSystem1","particleSystem2","creepsLength","creep","player","reachRight","reachBottom","health","maxHealth","creepDied","totalCreepKilled","textEvent","MovingEvents","size","rotation","moveRate","rotateRate","PI","continousSpeed","yDirection","xDirection","FlyingScore","towersLength","tower","flying","type","isColliding","radius","setTarget","canShoot","isFirst","direction","target","normalize","bulletStartX","bulletStartY","addBullet","scorelength","isVisible","newEnemy","createEnemy","innerHTML","waveString","wave","maxWave","totalTowerValues","forEach","context","clearRect","width","height","fillStyle","fillRect","enemyCreators","position","placementFlag","x1","y1","leftOffset","topOffset","beginPath","rect","stroke","moveTo","lineTo","drawTower","drawRectangle","fill","Sound","loadAudio","changeVolume","performance","now","gameLoop","time","totalEnemy","setTimeout","checkCanProceed","requestAnimationFrame","processInput","pauseSound","font","textAlign","fillText"],"mappings":"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","sourcesContent":["class GamePlay {\r\n  constructor(manager, input) {\r\n    this.myKeyboard = input;\r\n    this.myMouse = null;\r\n    this.lastTimeStamp;\r\n    this.manager = manager;\r\n    this.model = null;\r\n    this.initialize = this.initialize.bind(this);\r\n    this.run = this.run.bind(this);\r\n    this.playerModel = null;\r\n    self.wallModel = null;\r\n    this.renderCircle = false;\r\n    this.sound = null;\r\n    this.particlesSmoke = null;\r\n    this.creeps = [];\r\n    this.towers = [];\r\n    this.registerKey = this.registerKey.bind(this);\r\n    this.flyingScores = [];\r\n    this.tower1 = new Image();\r\n    this.tower1.src = \"assets/turret/turret-5-3.png\";\r\n    this.render = this.render.bind(this);\r\n    this.firstTime = true;\r\n    this.downHandler = this.downHandler.bind(this);\r\n    this.enemyCreator = null;\r\n    this.canPlace = false;\r\n    this.upgrade = this.upgrade.bind(this);\r\n    this.sell = this.sell.bind(this);\r\n    this.renderScore = this.renderScore.bind(this);\r\n    this.startNewWave = this.startNewWave.bind(this);\r\n    this.level = 0;\r\n    this.towerType = [\"Gun\", \"Missile\", \"Air\", \"Mix (Air + Ground)\"];\r\n    this.gameOverText = \"Game Over\";\r\n    this.alreadyUpgraded = false;\r\n    this.alreadyStarted = false;\r\n  }\r\n\r\n  upgrade(elapsedTime) {\r\n    if(!this.alreadyUpgraded){\r\n    let moneyRequired = Math.floor(1.2 * towerClicked.specs.cost);\r\n    if (moneyRequired <= money) {\r\n      if (towerClicked) {\r\n            if (!towerClicked.upgradeCount) {\r\n              towerClicked.upgradeCount = 1;\r\n            } else {\r\n              if (towerClicked.upgradeCount >= 3) {\r\n                return;\r\n              } else {\r\n                towerClicked.upgradeCount = towerClicked.upgradeCount + 1;\r\n                towerClicked.delay = Math.floor(towerClicked.delay * 0.7);\r\n                towerClicked.specs.power = towerClicked.specs.power + 1;\r\n                towerClicked.specs.cost = Math.floor(\r\n                  1.2 * towerClicked.specs.cost\r\n                );\r\n                money -= moneyRequired;\r\n                this.alreadyUpgraded = true;\r\n                gameSound.playSound(\"add\");\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n\r\n  sell() {\r\n    if (towerClicked) {\r\n      let towerLength = this.towers.length;\r\n      for (let i = 0; i < towerLength; i++) {\r\n        if (\r\n          isColliding2(\r\n            this.towers[i].specs.center.x - cellWidth / 2,\r\n            this.towers[i].specs.center.y - cellWidth / 2,\r\n            cellWidth,\r\n            towerClicked.specs.center.x - cellWidth / 2,\r\n            towerClicked.specs.center.y - cellWidth / 2,\r\n            cellWidth\r\n          )\r\n        ) {\r\n          money += Math.floor(0.7 * towerClicked.specs.cost);\r\n          towerSold(this.towers[i].specs.center.x - cellWidth / 2, this.towers[i].specs.center.y - cellWidth / 2);\r\n          this.towers.splice(i, 1);\r\n          gameSound.playSound(\"die\");\r\n          towerClicked = null;\r\n          return;\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  createElement() {\r\n    selectedTower = this.getAttribute(\"data-myName\");\r\n    towerRadius = this.getAttribute(\"data-radius\");\r\n    moneyRequired = parseInt(this.getAttribute(\"data-cost\"));\r\n    towerTypeSelected = parseInt(this.getAttribute(\"data-type\"));\r\n    if (moneyRequired <= money) {\r\n      renderCircle = true;\r\n      mouse.isActive = true;\r\n    }\r\n  }\r\n\r\n  downHandler(e, elapsedTime) {\r\n    if (mouse.isActive) {\r\n      firstTime = true;\r\n      mouse.isActive = false;\r\n      renderCircle = false;\r\n      let decision = canCreated(this.towers) && this.canPlace;\r\n      if (decision) {\r\n        this.towers.push(\r\n          createTower(\r\n            GameState.assets[selectedTower],\r\n            Math.floor(mouse.x / cellWidth) * cellWidth,\r\n            Math.floor((mouse.y - 200) / cellWidth) * cellWidth + 200,\r\n            2500,\r\n            1,\r\n            towerRadius,\r\n            moneyRequired,\r\n            towerTypeSelected\r\n          )\r\n        );\r\n        money = money - moneyRequired;\r\n        moneyRequired = 0;\r\n        towerTypeSelected = 0;\r\n        gameSound.playSound(\"add\");\r\n      }\r\n      const canvasPosition = canvas.getBoundingClientRect();\r\n    } else {\r\n      const canvasPosition = canvas.getBoundingClientRect();\r\n      mouse.x = e.clientX - canvasPosition.left;\r\n      mouse.y = e.clientY - canvasPosition.top;\r\n      findSelectedTower(this.towers);\r\n    }\r\n  }\r\n\r\n  muteVolume(e) {\r\n    e.preventDefault();\r\n    var towerElements = document.getElementsByClassName(\"volumeButton\");\r\n    for (var i = 0; i < towerElements.length; i++) {\r\n      towerElements[i].style.display = \"block\";\r\n    }\r\n    let myId = this.getAttribute(\"data-myId\");\r\n    document.getElementById(myId).style.display = \"none\";\r\n    if (myId == \"muteButton\") {\r\n      gameSound.stopAllSound();\r\n    }\r\n    if (myId == \"unmuteButton\") {\r\n      gameSound.unMuteSound();\r\n    }\r\n  }\r\n\r\n  startNewWave(e) {\r\n    // if(e){\r\n    //   e.preventDefault();\r\n    // }\r\n    console.log(\"start button clicked\");\r\n    this.enemyCreator = levels[this.level].sendNextWave();\r\n    startButton.style.display = \"none\";\r\n    nextWave = false;\r\n    GameState.cancelNextRequest = false;\r\n  }\r\n\r\n  checkCanProceed() {\r\n    if (this.level > 2){  \r\n      this.gameOverText = \"You Won !!!\";\r\n      GameState.cancelNextRequest = true;\r\n      add(score);\r\n    } \r\n    if(GameState.life <= 0) {\r\n      GameState.cancelNextRequest = true;\r\n      add(score);\r\n    \r\n    }\r\n    }\r\n\r\n  initialize() {\r\n    let self = this;\r\n    createLevels();\r\n    makeParticle2();\r\n    this.myMouse = new Mouse();\r\n    GameState.cancelNextRequest = false;\r\n    GameState.life = 10;\r\n    self.myKeyboard.register(\"Escape\", function () {\r\n      GameState.cancelNextRequest = true;\r\n      self.manager.showScreen(\"mainmenu\");\r\n    }, ()=>{});\r\n\r\n    for (let i = 0; i < rows; i++) {\r\n      let row = [];\r\n      for (let j = 0; j < cols; j++) {\r\n        row.push({\r\n          x: i,\r\n          y: j,\r\n        });\r\n      }\r\n      cellSet.push(row);\r\n    }\r\n\r\n    towerElements = document.getElementsByClassName(\"tower\");\r\n    for (var i = 0; i < towerElements.length; i++) {\r\n      towerElements[i].addEventListener(\"click\", this.createElement, false);\r\n    }\r\n\r\n    towerElements2 = document.getElementsByClassName(\"volumeButton\");\r\n    for (var i = 0; i < towerElements2.length; i++) {\r\n      towerElements2[i].addEventListener(\"click\", this.muteVolume, false);\r\n    }\r\n    startButton = document.getElementById(\"startButton\");\r\n    startButton.addEventListener(\"click\", this.startNewWave);\r\n\r\n    this.bulletController = new BulletController(this.creeps);\r\n\r\n\r\n    this.myMouse.register(\"mousedown\", this.downHandler);\r\n\r\n    this.myMouse.register(\"mousemove\", function (e, elapsedTime) {\r\n      if (mouse.isActive) {\r\n        const canvasPosition = canvas.getBoundingClientRect();\r\n        mouse.x = e.clientX - canvasPosition.left;\r\n        mouse.y = e.clientY - canvasPosition.top;\r\n        if (mouse.y < 200) {\r\n          mouse.y = 200;\r\n        }\r\n        this.renderCircle = true;\r\n      }\r\n    });\r\n  }\r\n\r\n  processInput(elapsedTime) {\r\n    this.myKeyboard.update(elapsedTime);\r\n    this.myMouse.update(elapsedTime);\r\n  }\r\n\r\n  registerKey() {\r\n    let self = this;\r\n    let upgrade = localStorage[\"upgrade\"];\r\n    let sell = localStorage[\"sell\"];\r\n    let start = localStorage[\"start\"];\r\n\r\n    self.myKeyboard.register(\r\n      upgrade,\r\n      function (elapsedTime) {\r\n        self.upgrade(elapsedTime);\r\n      },\r\n      function (elapsedTime) {\r\n        self.alreadyUpgraded = false;\r\n      }\r\n    );\r\n\r\n    self.myKeyboard.register(\r\n      sell,\r\n      function (elapsedTime) {\r\n        self.sell(elapsedTime);\r\n      },\r\n      () => {}\r\n    );\r\n\r\n    console.log(start);\r\n    self.myKeyboard.register(\r\n      start,\r\n      function (elapsedTime) {\r\n        if (!self.alreadyStarted) {\r\n          self.startNewWave(elapsedTime);\r\n          self.alreadyStarted = true;\r\n        }\r\n      },\r\n      function (elapsedTime) {}\r\n    );\r\n\r\n    // self.myKeyboard.cleanAll();\r\n  }\r\n\r\n  update(elapsedTime) {\r\n    if (GameState.life <= 0) {\r\n      GameState.cancelNextRequest = true;\r\n      // this.particlesSmoke.update(elapsedTime);\r\n      return;\r\n    }\r\n\r\n    particleSystem1.update(elapsedTime);\r\n    particleSystem2.update(elapsedTime);\r\n    let creepsLength = this.creeps.length;\r\n    for (let i = 0; i < creepsLength; i++) {\r\n      let creep = this.creeps[i];\r\n      if (creep) {\r\n        if (creep.player.reachRight() || creep.player.reachBottom()) {\r\n          this.creeps.splice(i, 1);\r\n          GameState.life--;\r\n          continue;\r\n        }\r\n        if (creep.health == 0) {\r\n          let x = creep.player.specs.center.x;\r\n          let y = creep.player.specs.center.y;\r\n          score += creep.maxHealth;\r\n          this.creeps.splice(i, 1);\r\n          creepDied(x, y);\r\n          totalCreepKilled++;\r\n          money += creep.maxHealth;\r\n          gameSound.playSound(\"die\");\r\n          let textEvent = new MovingEvents({\r\n            size: { x: 50, y: 50 },\r\n            center: { x: x, y: y },\r\n            rotation: 0,\r\n            moveRate: 125 / 1000, \r\n            rotateRate: Math.PI / 1000, \r\n            continousSpeed: 50,\r\n            yDirection: -1,\r\n            xDirection: 0,\r\n          });\r\n          this.flyingScores.push(\r\n            new FlyingScore(creep.maxHealth, textEvent, true)\r\n          );\r\n          continue;\r\n        }\r\n        creep.update(elapsedTime);\r\n        let towersLength = this.towers.length;\r\n        for (let i = 0; i < towersLength; i++) {\r\n          let tower = this.towers[i];\r\n          if (typeof creep.flying == \"undefined\" && tower.specs.type == 3) {\r\n            // console.log(\"flying\" + \" \" + i);\r\n          } else if (\r\n            typeof creep.flying != \"undefined\" &&\r\n            tower.specs.type < 3\r\n          ) {\r\n            // console.log(\"flying\" + \" \" + i);\r\n          } else {\r\n            if (isColliding(creep, tower, tower.specs.radius)) {\r\n              tower.setTarget(\r\n                creep.player.specs.center.x,\r\n                creep.player.specs.center.y\r\n              );\r\n              if (tower.canShoot) {\r\n                tower.isFirst = false;\r\n                let direction = {\r\n                  x: tower.specs.target.x - tower.specs.center.x,\r\n                  y: tower.specs.target.y - tower.specs.center.y,\r\n                };\r\n                direction = normalize(direction);\r\n                let bulletStartX = tower.specs.center.x;\r\n                let bulletStartY = tower.specs.center.y;\r\n\r\n                this.bulletController.addBullet(\r\n                  bulletStartX,\r\n                  bulletStartY,\r\n                  creep,\r\n                  tower.specs.power,\r\n                  tower.specs.type\r\n                );\r\n                gameSound.playSound(\"shoot\");\r\n              }\r\n            }\r\n          }\r\n\r\n          tower.update(elapsedTime);\r\n        }\r\n      }\r\n    }\r\n\r\n    this.bulletController.update(elapsedTime);\r\n    let scorelength = this.flyingScores.length;\r\n    for (let i = 0; i < scorelength; i++) {\r\n      this.flyingScores[i].update(elapsedTime);\r\n      if (!this.flyingScores[i].isVisible) {\r\n        this.flyingScores.splice(i, 1);\r\n        i--;\r\n        scorelength--;\r\n      }\r\n    }\r\n    if (this.enemyCreator) {\r\n      let newEnemy = this.enemyCreator.createEnemy(elapsedTime);\r\n      if (newEnemy) {\r\n        this.creeps.push(newEnemy);\r\n      }\r\n    }\r\n  }\r\n\r\n  renderScore() {\r\n    document.getElementById(\"currentScore\").innerHTML = score;\r\n    document.getElementById(\"lives\").innerHTML = GameState.life;\r\n    document.getElementById(\"money\").innerHTML = money;\r\n    if(this.level<3){\r\n      let waveString = (levels[this.level].wave + 1) + \"/\" + maxWave;\r\n      document.getElementById(\"wave\").innerHTML = waveString;\r\n    }\r\n    var startButton = document.getElementById(\"startButton\");\r\n    document.getElementById(\"level\").innerHTML = this.level + 1;\r\n    document.getElementById(\"killed\").innerHTML = totalCreepKilled;\r\n    // startButton.style.display = \"none\";\r\n    // if (nextWave) {\r\n    //   startButton.style.display = \"block\";\r\n    // }\r\n    let totalTowerValues = 0;\r\n    this.towers.forEach((tower) => {\r\n      totalTowerValues += tower.specs.cost;\r\n    });\r\n    document.getElementById(\"towerValue\").innerHTML = totalTowerValues;\r\n\r\n    if (moneyRequired > 0 || towerClicked) {\r\n      if (towerClicked) {\r\n        moneyRequired = Math.floor(1.2 * towerClicked.specs.cost);\r\n        towerTypeSelected = towerClicked.specs.type;\r\n      }\r\n      document.getElementById(\"selectedInfo\").style.display = \"block\";\r\n      document.getElementById(\"moneyRequired\").innerHTML = moneyRequired;\r\n      document.getElementById(\"power\").innerHTML =\r\n        this.towerType[parseInt(towerTypeSelected) - 1];\r\n    } else {\r\n      document.getElementById(\"selectedInfo\").style.display = \"none\";\r\n      document.getElementById(\"moneyRequired\").innerHTML = \"\";\r\n      document.getElementById(\"power\").innerHTML = \"\";\r\n    }\r\n  }\r\n\r\n  render() {\r\n    let self = this;\r\n    context.clearRect(0, 0, canvas.width, canvas.height);\r\n    context.fillStyle = \"green\";\r\n    context.fillRect(0, 0 + 200, 600, 800);\r\n    context.clearRect(50, 250, 500, 500);\r\n    context.clearRect(0, 400, 50, 200);\r\n    context.clearRect(550, 400, 50, 200);\r\n    context.clearRect(175, 200, 225, 50);\r\n    context.clearRect(175, 750, 225, 50);\r\n\r\n    if (nextWave && self.level < 3) {\r\n      // console.log(\r\n      //   levels[self.level].enemyCreators[levels[self.level].wave + 1].position\r\n      // );\r\n      if (\r\n        levels[self.level].enemyCreators[levels[self.level].wave + 1]\r\n          .position == \"top\"\r\n      ) {\r\n        // console.log(\"top\");\r\n        context.fillStyle = \"#d7a20e\";\r\n        context.fillRect(175, 0 + 200, 225, 50);\r\n      } else if (\r\n        levels[self.level].enemyCreators[levels[self.level].wave + 1]\r\n          .position == \"left\"\r\n      ) {\r\n        // console.log(\"left\");\r\n        context.fillStyle = \"#d7a20e\";\r\n        context.fillRect(0, 400, 50, 200);\r\n      }\r\n    }\r\n\r\n    if (mouse.isActive) {\r\n      let placementFlag = false;\r\n      for (let i = 0; i < rows; i++) {\r\n        for (let j = 0; j < cols; j++) {\r\n          let x1 = cellSet[i][j].x;\r\n          let y1 = cellSet[i][j].y;\r\n          if (\r\n            Math.floor((mouse.x - leftOffset) / cellWidth) == x1 &&\r\n            Math.floor((mouse.y - topOffset) / cellWidth) == y1\r\n          ) {\r\n            this.canPlace = true;\r\n            placementFlag = true;\r\n            context.beginPath();\r\n            context.rect(\r\n              x1 * cellWidth + leftOffset,\r\n              y1 * cellWidth + topOffset,\r\n              cellWidth,\r\n              cellWidth\r\n            );\r\n            context.stroke();\r\n          }\r\n        }\r\n      }\r\n      if (!placementFlag) {\r\n        this.canPlace = false;\r\n      }\r\n    }\r\n\r\n    // ctx.strokeRect(50, 50, 50, 50);\r\n\r\n    context.beginPath();\r\n    context.moveTo(0, 200);\r\n    context.lineTo(canvas.width, 200);\r\n    context.stroke();\r\n    if (renderCircle) {\r\n      drawTower(towerRadius);\r\n    }\r\n    context.fillStyle = \"black\";\r\n    this.renderScore();\r\n    this.creeps.forEach((creep) => {\r\n      creep.render();\r\n    });\r\n    let towersLength = this.towers.length;\r\n    for (let i = 0; i < towersLength; i++) {\r\n      let tower = this.towers[i];\r\n      tower.render();\r\n    }\r\n    if (towerClicked) {\r\n      drawRectangle({\r\n        x: towerClicked.specs.center.x - cellWidth / 2,\r\n        y: towerClicked.specs.center.y - cellWidth / 2,\r\n        width: 50,\r\n        height: 50,\r\n        fill: \"#ffd63f9e\",\r\n        stroke: \"red\",\r\n      });\r\n    } \r\n\r\n    this.bulletController.render();\r\n    let scorelength = this.flyingScores.length;\r\n    for (let i = 0; i < scorelength; i++) {\r\n      this.flyingScores[i].render();\r\n    }\r\n    particleSystem1.render();\r\n    particleSystem2.render();\r\n  }\r\n\r\n  run() {\r\n    let self = this;\r\n    gameSound = new Sound();\r\n    gameSound.loadAudio();\r\n    gameSound.playSound(\"game_play\");\r\n    gameSound.changeVolume(10);\r\n    this.registerKey();\r\n    let lastTimeStamp = performance.now();\r\n    GameState.cancelNextRequest = false;\r\n\r\n    context.fillStyle = \"black\";\r\n\r\n    function gameLoop(time) {\r\n      if (\r\n        self.enemyCreator &&\r\n        self.enemyCreator.totalEnemy <= 0 &&\r\n        self.creeps.length == 0 &&\r\n        wave > 0 &&\r\n        self.level < 3 &&\r\n        !nextWave\r\n      ) {\r\n        nextWave = true;\r\n        if (\r\n          levels[self.level].wave >=\r\n          levels[self.level].enemyCreators.length - 1\r\n        ) {\r\n          self.level++;\r\n          self.towers = [];\r\n          startButton.style.display = \"block\";\r\n          self.alreadyStarted = false;\r\n        }\r\n        else{\r\n          setTimeout(() => {\r\n            self.startNewWave();\r\n          }, 1000);  \r\n        }\r\n      }\r\n\r\n      self.checkCanProceed();\r\n      if (!GameState.cancelNextRequest) {\r\n        requestAnimationFrame(gameLoop);\r\n        self.processInput(time - lastTimeStamp);\r\n        self.update(time - lastTimeStamp);\r\n        lastTimeStamp = time;\r\n        self.render();\r\n      } else {\r\n        if (score > 0) {\r\n          add(score);\r\n        }\r\n        gameSound.pauseSound(\"game_play\");\r\n        gameSound.playSound(\"success_end\");\r\n        gameSound.changeVolume(20);\r\n        context.font = \"70px roboto\";\r\n        context.fillStyle = \"black\";\r\n        context.textAlign = \"center\";\r\n\r\n        context.fillText(\r\n          self.gameOverText,\r\n          canvas.width / 2,\r\n          canvas.height * 0.6\r\n        );\r\n        context.fillText(score, canvas.width / 2, canvas.height * 0.8);\r\n        setTimeout(() => {\r\n          self.manager.showScreen(\"mainmenu\");\r\n        }, 4000);\r\n      }\r\n      lastTimeStamp = time;\r\n    }\r\n    requestAnimationFrame(gameLoop);\r\n  }\r\n}\r\n"],"file":"game-play.dev.js"}
"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),e}var GamePlay=function(){function r(e,t){_classCallCheck(this,r),this.myKeyboard=t,this.lastTimeStamp,this.manager=e,this.model=null,this.initialize=this.initialize.bind(this),this.run=this.run.bind(this),this.playerModel=null,self.wallModel=null,this.sound=null,this.tower=null,this.registerKey=this.registerKey.bind(this)}return _createClass(r,[{key:"initialize",value:function(){var e=this;e.myKeyboard.register("Escape",function(){GameState.cancelNextRequest=!0,e.manager.showScreen("mainmenu")});var t={spriteSheet:dir+"assets/spritesheet-bird.png",spriteCount:14,spriteTime:[25,25,25,25,25,25,25,25,25,25,25,25,25,25]};this.wallEvent=new MovingEvents({size:{x:50,y:50},center:{x:250,y:250},rotation:0,moveRate:.125,rotateRate:Math.PI/1e3,continousSpeed:1});var r={spriteSheet:dir+"assets/spritesheet-bird.png",spriteCount:14,spriteTime:[25,25,25,25,25,25,25,25,25,25,25,25,25,25]};this.tower=new Tower({baseSprite:"assets/turret-base.gif",weaponSprite:"assets/turret-1-1.png",center:{x:500,y:500},target:{x:300,y:200},rotateRate:6*3.14159/1e3}),e.playerModel=new gameModel(t,this.playerEvent,!0),e.wallModel=new gameModel(r,this.wallEvent,!0),e.enemycontroller=new EnemyController(e.playerModel)}},{key:"processInput",value:function(e){this.myKeyboard.update(e)}},{key:"registerKey",value:function(){var e=this,t=localStorage.upgrade,r=localStorage.sell,a=localStorage.start;e.myKeyboard.cleanAll(),e.myKeyboard.register(t,e.playerEvent.moveForward),e.myKeyboard.register(r,e.playerEvent.rotateLeft),e.myKeyboard.register(a,e.playerEvent.rotateRight)}},{key:"update",value:function(e){GameState.life<=0?GameState.cancelNextRequest=!0:(this.playerModel.update(e),this.wallModel.update(e),this.tower.update(e),isColliding(this.playerModel,this.wallModel,100)&&this.sound.playSound("end"))}},{key:"renderScore",value:function(){document.getElementById("currentScore").innerHTML=score,document.getElementById("lives").innerHTML=GameState.life}},{key:"render",value:function(){context.clearRect(0,0,canvas.width,canvas.height),this.renderScore(),this.playerModel.render(),this.wallModel.render(),this.tower.render()}},{key:"run",value:function(){var r=this;this.sound=new Sound,this.sound.loadAudio(),this.registerKey(),this.myKeyboard.register("ArrowUp",r.playerModel.player.moveTop),this.myKeyboard.register("ArrowDown",r.playerModel.player.moveDown),this.myKeyboard.register("ArrowLeft",r.playerModel.player.moveLeft),this.myKeyboard.register("ArrowRight",r.playerModel.player.moveRight);var a=performance.now();GameState.cancelNextRequest=!1,requestAnimationFrame(function e(t){r.processInput(t-a),r.update(t-a),a=t,r.render(),GameState.cancelNextRequest||requestAnimationFrame(e)})}}]),r}();
//# sourceMappingURL=game-play.min.js.map

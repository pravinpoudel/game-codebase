{"version":3,"sources":["gameModel.js"],"names":["gameModel","specs","playerEvent","continousMotion","player","animationTime","subImageIndex","subTextureWidth","image","Image","isReady","loadedImage","secondTime","images","index","spriteSheet","forEach","src","onload","spriteCount","push","collided","health","maxHealth","flying","meterWidth","yoffsetBar","elapsedTime","spriteTime","update","reachRight","center","width","height","currentHealth","barHeight","context","fillStyle","left","x","top","y","fillRect","lifeWidth","Math","floor","rotation","size","save","translate","rotate","drawImage","restore","drawSubTexture","drawBar"],"mappings":"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","sourcesContent":["class gameModel {\r\n  constructor(specs, playerEvent, continousMotion) {\r\n    this.specs = specs;\r\n    this.player = playerEvent;\r\n\r\n    this.animationTime = 0;\r\n    this.subImageIndex = 0;\r\n    this.subTextureWidth = 0;\r\n\r\n    this.image = new Image();\r\n    this.isReady = false;\r\n    this.loadedImage = 0;\r\n    this.secondTime = false;\r\n\r\n    this.images = [];\r\n    this.index = 0;\r\n    specs.spriteSheet.forEach((src) => {\r\n      let image = new Image();\r\n      image.src = src;\r\n      image.onload = () => {\r\n        this.loadedImage++;\r\n        if (this.loadedImage == this.specs.spriteCount) this.isReady = true;\r\n      };\r\n      this.images.push(image);\r\n    });\r\n\r\n    // this.image.src = this.specs.spriteSheet;\r\n    this.continousMotion = continousMotion;\r\n    this.collided = false;\r\n    this.health = specs.health;\r\n    this.maxHealth = specs.health;\r\n    this.flying = specs.flying;\r\n    this.meterWidth = 40;\r\n    this.yoffsetBar = 20;\r\n  }\r\n\r\n  update(elapsedTime) {\r\n    this.animationTime += elapsedTime;\r\n    if (this.animationTime >= this.specs.spriteTime[this.subImageIndex]) {\r\n      this.animationTime -= this.specs.spriteTime[this.subImageIndex];\r\n      this.subImageIndex += 1;\r\n      this.subImageIndex = this.subImageIndex % this.specs.spriteCount;\r\n    }\r\n    if (this.continousMotion) {\r\n      this.player.update(elapsedTime);\r\n    }\r\n  }\r\n\r\n  reachRight() {\r\n    return this.player.reachRight();\r\n  }\r\n\r\n  drawBar(center, width, height, currentHealth, maxHealth) {\r\n    let barHeight = 5;\r\n    context.fillStyle = \"red\";\r\n    let left = center.x - this.meterWidth / 2;\r\n    let top = center.y - height / 2 - this.yoffsetBar - barHeight;\r\n    context.fillRect(left, top, this.meterWidth, barHeight);\r\n    context.fillStyle = \"green\";\r\n    let lifeWidth = Math.floor((currentHealth / maxHealth) * this.meterWidth);\r\n    context.fillRect(left, top, lifeWidth, barHeight);\r\n  }\r\n\r\n  drawSubTexture(image, index, subTextureWidth, center, rotation, size) {\r\n    context.save();\r\n    context.translate(center.x, center.y);\r\n    context.rotate(rotation);\r\n    context.translate(-center.x, -center.y);\r\n    // context.drawImage(image, this.x, this.y, image.width, image.height);\r\n    context.drawImage(\r\n      image,\r\n      center.x - image.width / 2, // Where to draw the sub-texture\r\n      center.y - image.height / 2,\r\n      image.width,\r\n      image.height\r\n    );\r\n    context.restore();\r\n  }\r\n\r\n  render() {\r\n    if (this.isReady) {\r\n      let image = this.images[this.subImageIndex];\r\n      this.drawSubTexture(\r\n        image,\r\n        this.subImageIndex,\r\n        this.subTextureWidth,\r\n        this.player.specs.center,\r\n        this.player.specs.rotation,\r\n        this.player.specs.size\r\n      );\r\n      this.drawBar(\r\n        this.player.specs.center,\r\n        image.width,\r\n        image.height,\r\n        this.health,\r\n        this.maxHealth\r\n      );\r\n      this.secondTime = true;\r\n    }\r\n  }\r\n}\r\n"],"file":"gameModel.dev.js"}
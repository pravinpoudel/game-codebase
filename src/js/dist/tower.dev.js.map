{"version":3,"sources":["tower.js"],"names":["Tower","spec","specs","baseSprite","Sprite","sprite","center","rotation","weaponSprite","update","bind","render","setTarget","canShoot","animationTime","delay","isFirst","x","y","target","elapsedTime","result","computeAngle","testTolerance","angle","crossProduct","rotateRight","rotateRate","rotateLeft","draw"],"mappings":";;;;;;;;IAAMA,K;;;AACJ,iBAAYC,IAAZ,EAAkB;AAAA;;AAChB,SAAKC,KAAL,GAAaD,IAAb;AACA,SAAKE,UAAL,GAAkB,IAAIC,MAAJ,CAAW;AAC3BC,MAAAA,MAAM,EAAEJ,IAAI,CAACE,UADc;AAE3BG,MAAAA,MAAM,EAAEL,IAAI,CAACK,MAFc;AAG3BC,MAAAA,QAAQ,EAAE;AAHiB,KAAX,CAAlB;AAKA,SAAKC,YAAL,GAAoB,IAAIJ,MAAJ,CAAW;AAC7BC,MAAAA,MAAM,EAAEJ,IAAI,CAACO,YADgB;AAE7BF,MAAAA,MAAM,EAAEL,IAAI,CAACK,MAFgB;AAG7BC,MAAAA,QAAQ,EAAE;AAHmB,KAAX,CAApB;AAKA,SAAKL,KAAL,CAAWK,QAAX,GAAsB,CAAtB;AACA,SAAKE,MAAL,GAAc,KAAKA,MAAL,CAAYC,IAAZ,CAAiB,IAAjB,CAAd;AACA,SAAKC,MAAL,GAAc,KAAKA,MAAL,CAAYD,IAAZ,CAAiB,IAAjB,CAAd;AACA,SAAKE,SAAL,GAAiB,KAAKA,SAAL,CAAeF,IAAf,CAAoB,IAApB,CAAjB;AACA,SAAKG,QAAL,GAAgB,IAAhB;AACA,SAAKC,aAAL,GAAqB,CAArB;AACA,SAAKC,KAAL,GAAa,KAAKb,KAAL,CAAWa,KAAxB;AACA,SAAKC,OAAL,GAAe,IAAf;AACD;;;;8BAESC,C,EAAGC,C,EAAG;AACd,WAAKhB,KAAL,CAAWiB,MAAX,GAAoB;AAClBF,QAAAA,CAAC,EAAEA,CADe;AAElBC,QAAAA,CAAC,EAAEA;AAFe,OAApB;AAID;;;mCAEc;AACb,WAAKL,QAAL,GAAgB,KAAhB;AACD;;;2BAEMO,W,EAAa;AAClB,UAAIC,MAAM,GAAGC,YAAY,CACvB,KAAKpB,KAAL,CAAWK,QADY,EAEvB,KAAKL,KAAL,CAAWI,MAFY,EAGvB,KAAKJ,KAAL,CAAWiB,MAHY,CAAzB;;AAKA,UAAII,aAAa,CAACF,MAAM,CAACG,KAAR,EAAe,CAAf,EAAkB,IAAlB,CAAb,KAAyC,KAA7C,EAAoD;AAClD,YAAIH,MAAM,CAACI,YAAP,GAAsB,CAA1B,EAA6B;AAC3B,eAAKjB,YAAL,CAAkBkB,WAAlB,CAA8B,KAAKxB,KAAL,CAAWyB,UAAzC;AACA,eAAKzB,KAAL,CAAWK,QAAX,IAAuB,KAAKL,KAAL,CAAWyB,UAAlC;AACD,SAHD,MAGO;AACL,eAAKnB,YAAL,CAAkBoB,UAAlB,CAA6B,KAAK1B,KAAL,CAAWyB,UAAxC;AACA,eAAKzB,KAAL,CAAWK,QAAX,IAAuB,KAAKL,KAAL,CAAWyB,UAAlC;AACD;AACF;;AACD,UAAI,KAAKX,OAAT,EAAkB;AAChB;AACD;;AACD,WAAKF,aAAL,IAAsBM,WAAtB;;AACA,UAAI,KAAKN,aAAL,GAAqB,KAAKZ,KAAL,CAAWa,KAApC,EAA2C;AACzC,aAAKD,aAAL,IAAsB,KAAKZ,KAAL,CAAWa,KAAjC;AACA,aAAKF,QAAL,GAAgB,IAAhB;AACD,OAHD,MAGO;AACL,aAAKA,QAAL,GAAgB,KAAhB;AACD;AACF;;;6BACQ;AACP,WAAKV,UAAL,CAAgB0B,IAAhB;AACA,WAAKrB,YAAL,CAAkBqB,IAAlB;AACD","sourcesContent":["class Tower {\r\n  constructor(spec) {\r\n    this.specs = spec;\r\n    this.baseSprite = new Sprite({\r\n      sprite: spec.baseSprite,\r\n      center: spec.center,\r\n      rotation: 0,\r\n    });\r\n    this.weaponSprite = new Sprite({\r\n      sprite: spec.weaponSprite,\r\n      center: spec.center,\r\n      rotation: 0,\r\n    });\r\n    this.specs.rotation = 0;\r\n    this.update = this.update.bind(this);\r\n    this.render = this.render.bind(this);\r\n    this.setTarget = this.setTarget.bind(this);\r\n    this.canShoot = true;\r\n    this.animationTime = 0;\r\n    this.delay = this.specs.delay;\r\n    this.isFirst = true;\r\n  }\r\n\r\n  setTarget(x, y) {\r\n    this.specs.target = {\r\n      x: x,\r\n      y: y,\r\n    };\r\n  }\r\n\r\n  removeTarget() {\r\n    this.canShoot = false;\r\n  }\r\n\r\n  update(elapsedTime) {\r\n    let result = computeAngle(\r\n      this.specs.rotation,\r\n      this.specs.center,\r\n      this.specs.target\r\n    );\r\n    if (testTolerance(result.angle, 0, 0.01) === false) {\r\n      if (result.crossProduct > 0) {\r\n        this.weaponSprite.rotateRight(this.specs.rotateRate);\r\n        this.specs.rotation += this.specs.rotateRate;\r\n      } else {\r\n        this.weaponSprite.rotateLeft(this.specs.rotateRate);\r\n        this.specs.rotation -= this.specs.rotateRate;\r\n      }\r\n    }\r\n    if (this.isFirst) {\r\n      return;\r\n    }\r\n    this.animationTime += elapsedTime;\r\n    if (this.animationTime > this.specs.delay) {\r\n      this.animationTime -= this.specs.delay;\r\n      this.canShoot = true;\r\n    } else {\r\n      this.canShoot = false;\r\n    }\r\n  }\r\n  render() {\r\n    this.baseSprite.draw();\r\n    this.weaponSprite.draw();\r\n  }\r\n}\r\n"],"file":"tower.dev.js"}
{"version":3,"sources":["loader.js"],"names":["progressSlice","loaderWidth","loader","scriptOrder","scripts","message","onComplete","href","window","dir","assetOrder","key","source","location","substring","lastIndexOf","require","entry","shift","loadScripts","loadAssets","loadAsset","assets","onError","fileExtension","xhr","responseType","asset","onload","onSuccess","mainComplete","canvas","document","getElementById","context","getContext","console","log","GameState","menu","initialize","totalItems","length","Math","floor","timerId","setTimeout","clearInterval","style","width","loaderInitiate","loaderHide","XMLHttpRequest","substr","open","status","Image","Audio","URL","revokeObjectURL","src","createObjectURL","response","send","loaderParent","error","display"],"mappings":"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","file":"loader.min.js","sourcesContent":["let progressSlice;\r\nlet loaderWidth = 1;\r\n\r\nloader = (function () {\r\n  \"use strict\";\r\n  let scriptOrder = [\r\n    {\r\n      scripts: [\"random\"],\r\n      message: \"Random number generator loaded\",\r\n      onComplete: null,\r\n    },\r\n\r\n    {\r\n      scripts: [\"highscore\"],\r\n      message: \"highscore intialized\",\r\n      onComplete: null,\r\n    },\r\n\r\n    {\r\n      scripts: [\"particleSystem\"],\r\n      message: \"particle system is intialized\",\r\n      onComplete: null,\r\n    },\r\n\r\n    {\r\n      scripts: [\"utility/enemyCreator\"],\r\n      message: \"enemy creator system is intialized\",\r\n      onComplete: null,\r\n    },\r\n\r\n    {\r\n      scripts: [\"utility/turretCreator\"],\r\n      message: \"tower creation system is intialized\",\r\n      onComplete: null,\r\n    },\r\n\r\n    {\r\n      scripts: [\"screens/about\"],\r\n      message: \"about is loaded\",\r\n      onComplete: null,\r\n    },\r\n\r\n    {\r\n      scripts: [\"bullet\"],\r\n      message: \"bullet is loaded\",\r\n      onComplete: null,\r\n    },\r\n\r\n    {\r\n      scripts: [\"bulletcontroller\"],\r\n      message: \"bulletcontroller is loaded\",\r\n      onComplete: null,\r\n    },\r\n\r\n    {\r\n      scripts: [\"screens/game-play\"],\r\n      message: \" game-play is loaded\",\r\n      onComplete: null,\r\n    },\r\n\r\n    {\r\n      scripts: [\"screens/help\"],\r\n      message: \"help is loaded\",\r\n      onComplete: null,\r\n    },\r\n\r\n    {\r\n      scripts: [\"screens/highscores\"],\r\n      message: \"highscore is loaded\",\r\n      onComplete: null,\r\n    },\r\n\r\n    {\r\n      scripts: [\"screens/control\"],\r\n      message: \"control is loaded\",\r\n      onComplete: null,\r\n    },\r\n\r\n    {\r\n      scripts: [\"screens/mainmenu\"],\r\n      message: \"mainmenu is loaded\",\r\n      onComplete: null,\r\n    },\r\n\r\n    {\r\n      scripts: [\"screens/menumanager\"],\r\n      message: \"menumanager is loaded\",\r\n      onComplete: null,\r\n    },\r\n\r\n    {\r\n      scripts: [\"utility/text\"],\r\n      message: \"enemy is loaded\",\r\n      onComplete: null,\r\n    },\r\n\r\n    {\r\n      scripts: [\"tower\"],\r\n      message: \"enemy is loaded\",\r\n      onComplete: null,\r\n    },\r\n\r\n    {\r\n      scripts: [\"sprite\"],\r\n      message: \"enemy is loaded\",\r\n      onComplete: null,\r\n    },\r\n\r\n    {\r\n      scripts: [\"enemy\"],\r\n      message: \"enemy is loaded\",\r\n      onComplete: null,\r\n    },\r\n\r\n    {\r\n      scripts: [\"enemyController\"],\r\n      message: \"enemyController is loaded\",\r\n      onComplete: null,\r\n    },\r\n\r\n    {\r\n      scripts: [\"input/input\"],\r\n      message: \"input is loaded\",\r\n      onComplete: null,\r\n    },\r\n\r\n    {\r\n      scripts: [\"input/mouse\"],\r\n      message: \"Mouse inputHandler is loaded\",\r\n      onComplete: null,\r\n    },\r\n\r\n    {\r\n      scripts: [\"gamemodel\"],\r\n      message: \"modelAnimation is loaded\",\r\n      onComplete: null,\r\n    },\r\n\r\n    {\r\n      scripts: [\"movingevents\"],\r\n      message: \"moving object is loaded\",\r\n      onComplete: null,\r\n    },\r\n\r\n    {\r\n      scripts: [\"sound\"],\r\n      message: \"sound intialized\",\r\n      onComplete: null,\r\n    },\r\n\r\n    {\r\n      scripts: [\"utility/initialize\"],\r\n      message: \"game menu intialized\",\r\n      onComplete: null,\r\n    },\r\n  ];\r\n  var href = window.location.href;\r\n  var dir = href.substring(0, href.lastIndexOf(\"/\")) + \"/\";\r\n\r\n  let assetOrder = [\r\n    {\r\n      key: \"fire\",\r\n      source: dir + \"assets/fire.png\",\r\n    },\r\n    {\r\n      key: \"smoke\",\r\n      source: dir + \"assets/smoke.png\",\r\n    },\r\n\r\n    {\r\n      key: \"tower1\",\r\n      source: dir + \"assets/turret/turret-1-1.png\",\r\n    },\r\n\r\n    {\r\n      key: \"tower2\",\r\n      source: dir + \"assets/turret/turret-6-1.png\",\r\n    },\r\n\r\n    {\r\n      key: \"tower3\",\r\n      source: dir + \"assets/turret/turret-4-1.png\",\r\n    },\r\n\r\n    {\r\n      key: \"base\",\r\n      source: dir + \"assets/turret/turret-base.png\",\r\n    },\r\n\r\n    {\r\n      key: \"creep10\",\r\n      source: dir + \"assets/creeps1/1.png\",\r\n    },\r\n\r\n    {\r\n      key: \"creep11\",\r\n      source: dir + \"assets/creeps1/2.png\",\r\n    },\r\n\r\n    {\r\n      key: \"creep12\",\r\n      source: dir + \"assets/creeps1/3.png\",\r\n    },\r\n\r\n    {\r\n      key: \"creep13\",\r\n      source: dir + \"assets/creeps1/4.png\",\r\n    },\r\n\r\n    {\r\n      key: \"creep14\",\r\n      source: dir + \"assets/creeps1/5.png\",\r\n    },\r\n\r\n    {\r\n      key: \"creep15\",\r\n      source: dir + \"assets/creeps1/6.png\",\r\n    },\r\n\r\n    {\r\n      key: \"creep20\",\r\n      source: dir + \"assets/creeps2/1.png\",\r\n    },\r\n\r\n    {\r\n      key: \"creep21\",\r\n      source: dir + \"assets/creeps2/2.png\",\r\n    },\r\n\r\n    {\r\n      key: \"creep22\",\r\n      source: dir + \"assets/creeps2/3.png\",\r\n    },\r\n\r\n    {\r\n      key: \"creep23\",\r\n      source: dir + \"assets/creeps2/4.png\",\r\n    },\r\n\r\n    {\r\n      key: \"creep30\",\r\n      source: dir + \"assets/creeps3/1.png\",\r\n    },\r\n\r\n    {\r\n      key: \"creep31\",\r\n      source: dir + \"assets/creeps3/2.png\",\r\n    },\r\n\r\n    {\r\n      key: \"creep32\",\r\n      source: dir + \"assets/creeps3/3.png\",\r\n    },\r\n\r\n    {\r\n      key: \"creep33\",\r\n      source: dir + \"assets/creeps3/4.png\",\r\n    },\r\n    // {\r\n    //   key: \"end audio\",\r\n    //   source: dir + \"assets/sounds/game_end.mp3\",\r\n    // },\r\n  ];\r\n\r\n  function loadScripts(scripts, onComplete) {\r\n    if (scripts.length > 0) {\r\n      let entry = scripts[0];\r\n      require(entry.scripts, function () {\r\n        if (entry.onComplete) {\r\n          entry.onComplete();\r\n        }\r\n        scripts.shift(); // Alternatively: scripts.splice(0, 1);\r\n        loaderWidth += progressSlice;\r\n        loadScripts(scripts, onComplete);\r\n      });\r\n    } else {\r\n      onComplete();\r\n    }\r\n  }\r\n\r\n  function loadAssets(assets, onSuccess, onError, onComplete) {\r\n    //\r\n    // When we run out of things to load, that is when we call onComplete.\r\n    if (assets.length > 0) {\r\n      let entry = assets[0];\r\n      loadAsset(\r\n        entry.source,\r\n        function (asset) {\r\n          onSuccess(entry, asset);\r\n          assets.shift(); // Alternatively: assets.splice(0, 1);\r\n          loaderWidth += progressSlice;\r\n          loadAssets(assets, onSuccess, onError, onComplete);\r\n        },\r\n        function (error) {\r\n          console.log(error.message);\r\n          onError(error);\r\n          assets.shift(); // Alternatively: assets.splice(0, 1);\r\n          loadAssets(assets, onSuccess, onError, onComplete);\r\n        }\r\n      );\r\n    } else {\r\n      onComplete();\r\n    }\r\n  }\r\n\r\n  function loadAsset(source, onSuccess, onError) {\r\n    let xhr = new XMLHttpRequest();\r\n    let fileExtension = source.substr(source.lastIndexOf(\".\") + 1); // Source: http://stackoverflow.com/questions/680929/how-to-extract-extension-from-filename-string-in-javascript\r\n\r\n    if (fileExtension) {\r\n      xhr.open(\"GET\", source, true);\r\n      xhr.responseType = \"blob\";\r\n\r\n      xhr.onload = function () {\r\n        let asset = null;\r\n        if (xhr.status === 200) {\r\n          if (fileExtension === \"png\" || fileExtension === \"jpg\") {\r\n            asset = new Image();\r\n          } else if (fileExtension === \"mp3\") {\r\n            asset = new Audio();\r\n          } else {\r\n            if (onError) {\r\n              onError(\"Unknown file extension: \" + fileExtension);\r\n            }\r\n          }\r\n          asset.onload = function () {\r\n            window.URL.revokeObjectURL(asset.src);\r\n            if (onSuccess) {\r\n              onSuccess(asset);\r\n            }\r\n          };\r\n          asset.src = window.URL.createObjectURL(xhr.response);\r\n        } else {\r\n          if (onError) {\r\n            onError(\"Failed to retrieve: \" + source);\r\n          }\r\n        }\r\n      };\r\n    } else {\r\n      if (onError) {\r\n        onError(\"Unknown file extension: \" + fileExtension);\r\n      }\r\n    }\r\n\r\n    xhr.send();\r\n  }\r\n\r\n  function mainComplete() {\r\n    canvas = document.getElementById(\"canvas-main\");\r\n    context = canvas.getContext(\"2d\");\r\n    console.log(GameState);\r\n    // const game1 = new Game();\r\n    GameState.menu.initialize();\r\n  }\r\n\r\n  function loaderInitiate() {\r\n    let totalItems = assetOrder.length + scriptOrder.length;\r\n    console.log(\"hello\");\r\n    progressSlice = Math.floor(100 / totalItems);\r\n    let loader = document.getElementById(\"loader\");\r\n    let timerId = setTimeout(loop, 1000);\r\n\r\n    function loop() {\r\n      if (loaderWidth >= 100) {\r\n        clearInterval(timerId);\r\n      } else {\r\n        loader.style.width = loaderWidth + \"%\";\r\n      }\r\n      console.log(loaderWidth);\r\n    }\r\n  }\r\n\r\n  function loaderHide() {\r\n    let loaderParent = document.getElementById(\"loader_wrapper\");\r\n    loaderParent.style.display = \"none\";\r\n  }\r\n\r\n  loaderInitiate();\r\n  loadAssets(\r\n    assetOrder,\r\n    function (source, asset) {\r\n      // Store it on success\r\n      GameState.assets[source.key] = asset;\r\n    },\r\n    function (error) {\r\n      console.log(error);\r\n    },\r\n    function () {\r\n      loadScripts(scriptOrder, mainComplete);\r\n    }\r\n  );\r\n  loaderHide();\r\n})();\r\n"]}